import { ResponsiveTable, ResponsiveTableCell } from '@/components/ResponsiveTable';
import { MAJOR_VERSIONS } from '@/data/frameworks';
import { Tabs, TableCell, TableBody, TableHead, TableRow, Alert } from '@aws-amplify/ui-react';

export const latestVersion = MAJOR_VERSIONS['react-native'][0];
export const prevVersion = MAJOR_VERSIONS['react-native'][1];

## Override Function Calls

You can override the call to `signUp`, `signIn`, `confirmSignIn`, `confirmSignUp`, `resetPassword` and `resetPasswordSubmit` functions.
To override a call you must create a new `services` object with an `async` `handle*` function that returns an `aws-amplify` `Auth.*` promise.

The service object must then be passed into the `authenticator` component as a `services` prop. For example, let's imagine you'd like to lowercase the `username` and the `email` attributes during `signUp`.
This would be overriden like so:

<Tabs.Container defaultValue={latestVersion}>
  <Tabs.List>
    <Tabs.Item value={latestVersion}>Version {latestVersion}</Tabs.Item>
    <Tabs.Item value={prevVersion}>Version {prevVersion}</Tabs.Item>
  </Tabs.List>
  <Tabs.Panel value={latestVersion}>
    ```jsx{6} expoSnack file=../../../../../../../examples/react-native/src/features/Authenticator/OverrideServices/Example.tsx

    ```
  </Tabs.Panel>
    <Tabs.Panel value={prevVersion}>
      <Alert role="none" variation="warning" heading="Sign Up Auto Sign In">
        When overriding `signUp` in **version {prevVersion}** you must include the `autoSignIn` key and set `enabled` to true, as show in the example below.
      </Alert>
      ```jsx{4, 24}
        import React from 'react';
        import { Button } from 'react-native';
        import { Authenticator, useAuthenticator } from '@aws-amplify/ui-react-native';
        import { Amplify, Auth } from 'aws-amplify';
        import awsconfig from './aws-exports';
        Amplify.configure(awsconfig);

        function SignOutButton() {
          const { signOut } = useAuthenticator();
          return <Button title="Sign Out" onPress={signOut} />;
        }

        const services = {
          async handleSignUp(formData) {
            let { username, password, attributes } = formData;
            // custom username
            username = username.toLowerCase();
            attributes.email = attributes.email.toLowerCase();
            return Auth.signUp({
              username,
              password,
              attributes,
              autoSignIn: {
                enabled: true,
              },
            });
          },
        };

        function App() {
          return (
            <Authenticator.Provider>
              <Authenticator services={services} >
                <SignOutButton />
              </Authenticator>
            </Authenticator.Provider>
          );
        }

        export default App;
    ```
  </Tabs.Panel>
</Tabs.Container>




Each `handle*` function will return the neccessary values you'll need to make the call to the `Auth` function call. Here is a table of each override function name, and the values returned from `formData`.
<Tabs.Container defaultValue={latestVersion}>
  <Tabs.List>
    <Tabs.Item value={latestVersion}>Version {latestVersion}</Tabs.Item>
  <Tabs.Item value={prevVersion}>Version {prevVersion}</Tabs.Item>
  </Tabs.List>
  <Tabs.Panel value={latestVersion}>
    <ResponsiveTable labelWidth="10rem">
      <TableHead>
        <TableRow>
          <TableCell as="th">Function Call</TableCell>
          <TableCell as="th">Override Name</TableCell>
          <TableCell as="th">formData Properties</TableCell>
        </TableRow>
      </TableHead>
      <TableBody>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`signUp`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleSignUp`</ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{username, password}`</ResponsiveTableCell>
        </TableRow>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`signIn`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleSignIn` </ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{username, password}`</ResponsiveTableCell>
        </TableRow>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`confirmSignIn`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleConfirmSignIn`</ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{challengeResponse}`</ResponsiveTableCell>
        </TableRow>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`confirmSignUp`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleConfirmSignUp`</ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{username, confirmationCode}`</ResponsiveTableCell>
        </TableRow>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`resetPassword`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleResetPassword`</ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{username}`</ResponsiveTableCell>
        </TableRow>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`confirmResetPassword`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleConfirmResetPassword`</ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{username, newPassword, confirmationCode}`</ResponsiveTableCell>
        </TableRow>
      </TableBody>
    </ResponsiveTable>
  </Tabs.Panel>
  <Tabs.Panel value={prevVersion}>
  <ResponsiveTable labelWidth="10rem">
    <TableHead>
      <TableRow>
        <TableCell as="th">Function Call</TableCell>
        <TableCell as="th">Override Name</TableCell>
        <TableCell as="th">formData Properties</TableCell>
      </TableRow>
    </TableHead>
      <TableBody>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`Auth.signUp`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleSignUp`</ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{username, password, attributes }`</ResponsiveTableCell>
        </TableRow>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`Auth.signIn`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleSignIn` </ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{username, password}`</ResponsiveTableCell>
        </TableRow>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`Auth.confirmSignIn`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleConfirmSignIn`</ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{user, code, mfaType}`</ResponsiveTableCell>
        </TableRow>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`Auth.confirmSignUp`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleConfirmSignUp`</ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{username, code}`</ResponsiveTableCell>
        </TableRow>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`Auth.forgotPassword`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleForgotPassword`</ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{username}`</ResponsiveTableCell>
        </TableRow>
        <TableRow>
          <ResponsiveTableCell label="Function Call">`Auth.forgotPasswordSubmit`</ResponsiveTableCell>
          <ResponsiveTableCell label="Override Name">`handleForgotPasswordSubmit`</ResponsiveTableCell>
          <ResponsiveTableCell label="formData Properties">`{username, code, password}`</ResponsiveTableCell>
        </TableRow>
      </TableBody>
    </ResponsiveTable>
  </Tabs.Panel>
</Tabs.Container>
